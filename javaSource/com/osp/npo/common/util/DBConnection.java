/** * DBConnection.java * * @author  Nguyen Trong Hoan * Created on Jul 03, 2008 */package com.osp.npo.common.util;import java.sql.*;import javax.sql.*;import javax.naming.*;/** * Database connection *  * @author HaiNT * @version $Revision: 17051 $ */public class DBConnection {    private DataSource ds = null;    private String mDriver = null;    private String mUrl = null;    private String mUser = null;    private String mPassword = null;    private boolean mAutoCommit = false;    /**     * Constructor method     *      * @param dsName :     */    public DBConnection(String dsName) throws javax.naming.NamingException {        try {            Context initCtx = null;            Context envCtx = null;            initCtx = new InitialContext();            envCtx = (Context) initCtx.lookup("java:comp/env");            ds = (DataSource) envCtx.lookup(dsName);        } catch (javax.naming.NamingException ex) {            throw ex;        }    }    /**     * Constructor method     *      * @param host     * @param port     * @param dbname     * @param user     * @param password     * @param driver     * @param url_prefix     */    public DBConnection(String host, String port, String dbname, String user,            String password, String driver, String urlPrefix) {        mDriver = driver;        mUrl = urlPrefix + "@//" + host + ":" + port + "/" + dbname;        mUser = user;        mPassword = password;    }    public DBConnection(String host, String port, String dbname, String user,            String password, String driver, String urlPrefix, boolean autoCommit) {        mDriver = driver;        mUrl = urlPrefix + "@//" + host + ":" + port + "/" + dbname;        mUser = user;        mPassword = password;        mAutoCommit = autoCommit;    }    /**     * Open connection     *      *      * @return Connection     */    public Connection openConnection() throws ClassNotFoundException,            SQLException {        Connection connection = null;        if (ds == null) {            Class.forName(mDriver);            connection = DriverManager.getConnection(mUrl, mUser, mPassword);        } else {            connection = ds.getConnection();        }        connection.setAutoCommit(mAutoCommit);        return connection;    }}